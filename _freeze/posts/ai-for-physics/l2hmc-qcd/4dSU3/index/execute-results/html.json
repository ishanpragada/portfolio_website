{
  "hash": "36c996438e6a1f1b398817b175d3294d",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"ðŸ”³ <code>l2hmc-qcd</code> Example: 4D SU(3)\"\ndate: 2023-12-06\njupyter:\n  jupytext:\n    formats: 'ipynb,py,qmd'\n    text_representation:\n      extension: .qmd\n      format_name: quarto\n      format_version: '1.0'\n      jupytext_version: 1.16.2\n  kernelspec:\n    display_name: Python 3 (ipykernel)\n    language: python\n    name: python3\n---\n\n\n\n\n## Imports\n\n```python\n# %load_ext autoreload\n# %autoreload 2\n# %matplotlib inline\nimport os\nfrom pathlib import Path\nfrom typing import Optional\nimport logging\n\nimport matplotlib_inline\nimport matplotlib.pyplot as plt\n\nimport torch\nimport yaml\n\nimport ambivalent\n\nimport numpy as np\n\nimport lovely_tensors as lt\nlt.monkey_patch()\n\nmatplotlib_inline.backend_inline.set_matplotlib_formats('svg')\n\nos.environ['CUDA_VISIBLE_DEVICES'] = '6'\nos.environ['COLORTERM'] = 'truecolor;'\nport = np.random.randint(5000, 6000)\nos.environ['MASTER_PORT'] = f\"{port}\"\n\nlog_config = get_logging_config()\nlog = logging.getLogger('name')\nlog.setLevel(\"INFO\")\n\nfrom l2hmc.utils.dist import setup_torch\nRANK = setup_torch(precision='float64', backend='DDP', seed=4351)\n\nplt.style.use(ambivalent.STYLES[\"ambivalent\"])\nplt.rcParams['figure.figsize'] = plt.rcParamsDefault['figure.figsize']\n```\n\n<!-- ```{python} -->\n<!-- import ezpz as ez -->\n<!-- ``` -->\n\n<!-- ::: {.callout-tip icon=\"false\" title=\"output:\", style=\"style=\"width:100%; background-color: var(--bg-transparent)!important; border-color: var(--collapsed-border-color)!important;\"} -->\n\n::: {.callout-tip icon=false aria-title=\"output\" title='[`output`:]{.dim-text}' collapse=\"true\" style=\"text-align: left!important; width:100%; background-color:rgba(131,131,131,0.05)!important; border: 1px solid rgba(131,131,131,0.3)!important; opacity:100%;\"}\n\n::: {.cell-output .cell-output-display}\n\n[Sams-MacBook-Pro.local:56401] shmem: mmap: an error occurred while determining whether or not /var/folders/53/5t2nv83136j76rld14vgfh2h0000gq/T//ompi.Sams-MacBook-Pro.503/jf.0/226820096/sm_segment.Sams-MacBook-Pro.503.d850000.0 could be created.  \n\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:34</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">__init__</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">136</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Setting logging level to <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'INFO'</span> on <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'RANK == 0'</span>  \n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:34</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">__init__</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">137</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Setting logging level to <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'CRITICAL'</span> on <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'RANK != 0'</span><br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:34</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">__init__</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">138</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>To disable this behavior, and log from ALL ranks <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">(</span>not recommended<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">)</span>, set: <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'export LOG_FROM_ALL_RANKS=1'</span> in your environment, and re-run.<br>\nUsing device: cpu\n[2024-07-04 11:44:38,445] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to mps (auto detect)\nW0704 11:44:39.287000 8461388800 torch/distributed/elastic/multiprocessing/redirects.py:27] NOTE: Redirects are currently not supported in Windows or MacOs.\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:39</span><span style=\"color:#333333;\">][</span><span style=\"color: #F4511E; text-decoration-color: #F4511E\">WARNING</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">dist</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">332</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Setting default dtype: float64\n<br>\n:::\n\n:::\n\n```python\ndef savefig(fig: plt.Figure, fname: str, outdir: os.PathLike):\n    pngfile = Path(outdir).joinpath(f\"pngs/{fname}.png\")\n    svgfile = Path(outdir).joinpath(f\"svgs/{fname}.svg\")\n    pngfile.parent.mkdir(exist_ok=True, parents=True)\n    svgfile.parent.mkdir(exist_ok=True, parents=True)\n    fig.savefig(svgfile, transparent=True, bbox_inches='tight')\n    fig.savefig(pngfile, transparent=True, bbox_inches='tight', dpi=300)\n```\n\n```python\ndef plot_metrics(metrics: dict, title: Optional[str] = None, **kwargs):\n    from l2hmc.utils.rich import is_interactive\n    from l2hmc.configs import QUARTO_OUTPUTS_DIR\n    outdir = Path(f\"{QUARTO_OUTPUTS_DIR}/plots-4dSU3/{title}\")\n    outdir.mkdir(exist_ok=True, parents=True)\n    for key, val in metrics.items():\n        fig, ax = plot_metric(val, name=key, **kwargs)\n        if title is not None:\n            ax.set_title(title)\n        log.info(f\"Saving {key} to {outdir}\")\n        savefig(fig, f\"{key}\", outdir=outdir)\n        if not is_interactive():\n            plt.show()\n```\n\n```python\ndef plot_metric(\n        metric: torch.Tensor,\n        name: Optional[str] = None,\n        **kwargs,\n):\n    assert len(metric) > 0\n    if isinstance(metric[0], (int, float, bool, np.floating)):\n        y = np.stack(metric)\n        return plot_scalar(y, ylabel=name, **kwargs)\n    element_shape = metric[0].shape\n    if len(element_shape) == 2:\n        if isinstance(metric, torch.Tensor):\n            y = grab_tensor(torch.stack(metric))\n        else:\n            y = np.stack(metric)\n        return plot_leapfrogs(y, ylabel=name)\n    if len(element_shape) == 1:\n        if isinstance(metric, torch.Tensor):\n            y = grab_tensor(torch.stack(metric))\n        else:\n            y = np.stack(metric)\n        return plot_chains(y, ylabel=name, **kwargs)\n    if len(element_shape) == 0:\n        if isinstance(metric, torch.Tensor):\n            y = grab_tensor(torch.stack(metric))\n        else:\n            y = np.stack(metric)\n        return plot_scalar(y, ylabel=name, **kwargs)\n    raise ValueError\n```\n\n```python\ndef main():\n    from l2hmc.experiment.pytorch.experiment import train_step\n    from l2hmc.configs import CONF_DIR\n    su3conf = Path(CONF_DIR).joinpath('su3-min-cpu.yaml')\n    assert su3conf.is_file()\n    # su3conf = Path('su3-min-cpu.yaml')\n    with su3conf.open('r') as stream:\n        conf = dict(yaml.safe_load(stream))\n\n    log.info(conf)\n    overrides = dict_to_list_of_overrides(conf)\n    ptExpSU3 = get_experiment(overrides=[*overrides], build_networks=True)\n    state = ptExpSU3.trainer.dynamics.random_state(6.0)\n    assert isinstance(state.x, torch.Tensor)\n    assert isinstance(state.beta, torch.Tensor)\n    assert isinstance(ptExpSU3, Experiment)\n    xhmc, history_hmc = evaluate(\n        nsteps=100,\n        exp=ptExpSU3,\n        beta=state.beta,\n        x=state.x,\n        eps=0.1,\n        nleapfrog=1,\n        job_type='hmc',\n        nlog=1,\n        nprint=2,\n        grab=True\n    )\n    xhmc = ptExpSU3.trainer.dynamics.unflatten(xhmc)\n    log.info(f\"checkSU(x_hmc): {g.checkSU(xhmc)}\")\n    plot_metrics(history_hmc.history, title='HMC', marker='.')\n    # ptExpSU3.trainer.dynamics.init_weights(\n    #     method='uniform',\n    #     min=-1e-16,\n    #     max=1e-16,\n    #     bias=True,\n    #     # xeps=0.001,\n    #     # veps=0.001,\n    # )\n    xeval, history_eval = evaluate(\n        nsteps=10,\n        exp=ptExpSU3,\n        beta=6.0,\n        x=state.x,\n        job_type='eval',\n        nlog=1,\n        nprint=2,\n        grab=True,\n    )\n    xeval = ptExpSU3.trainer.dynamics.unflatten(xeval)\n    log.info(f\"checkSU(x_eval): {g.checkSU(xeval)}\")\n    plot_metrics(history_eval.history, title='Evaluate', marker='.')\n\n    history = {}\n    x = state.x\n    for step in range(20):\n        log.info(f'TRAIN STEP: {step}')\n        x, metrics = ptExpSU3.trainer.train_step((x, state.beta))\n        if (step > 0 and step % 2 == 0):\n            print_dict(metrics, grab=True)\n        if (step > 0 and step % 1 == 0):\n            for key, val in metrics.items():\n                try:\n                    history[key].append(val)\n                except KeyError:\n                    history[key] = [val]\n\n    x = ptExpSU3.trainer.dynamics.unflatten(x)\n    log.info(f\"checkSU(x_train): {g.checkSU(x)}\")\n    plot_metrics(history, title='train', marker='.')\n    #\n    # for step in range(20):\n    #     log.info(f\"train step: {step}\")\n    #     x, metrics = ptExpSU3.trainer.train_step((x, state.beta))\n    #     if step % 5 == 0:\n    #         print_dict(metrics, grab=True)\n\n    return x, history\n```\n\n```python\n# main()\nfrom l2hmc.experiment.pytorch.experiment import train_step\n\nfrom l2hmc.configs import CONF_DIR\nsu3conf = Path(CONF_DIR).joinpath('su3-min-cpu.yaml')\nassert su3conf.is_file()\n# su3conf = Path('./conf/su3-min-cpu.yaml')\nwith su3conf.open('r') as stream:\n    conf = dict(yaml.safe_load(stream))\n\nlog.info(conf)\noverrides = dict_to_list_of_overrides(conf)\nptExpSU3 = get_experiment(overrides=[*overrides], build_networks=True)\n```\n\n::: {.callout-tip icon=false aria-title=\"output\" title='[`output`:]{.dim-text}' collapse=\"true\" style=\"text-align: left!important; width:100%; background-color:rgba(131,131,131,0.05)!important; border: 1px solid rgba(131,131,131,0.3)!important; opacity:100%;\"}\n\n::: {.cell-output .cell-output-display}\n\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:39</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1705502108</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">11</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">{</span><span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'annealing_schedule'</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">{</span><span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'beta_final'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">6.0</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'beta_init'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">6.0</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">}</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'backend'</span>: <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'DDP'</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'conv'</span>: <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'none'</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'dynamics'</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">{</span><span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'eps'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.1</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'eps_fixed'</span>: <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">True</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'group'</span>: <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'SU3'</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'latvolume'</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'nchains'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'nleapfrog'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'use_separate_networks'</span>: <span style=\"color: #ff0000; text-decoration-color: #ff0000; font-style: italic\">False</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'use_split_xnets'</span>: <span style=\"color: #ff0000; text-decoration-color: #ff0000; font-style: italic\">False</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'verbose'</span>: <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">True</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">}</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'framework'</span>: <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'pytorch'</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'init_aim'</span>: <span style=\"color: #ff0000; text-decoration-color: #ff0000; font-style: italic\">False</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'init_wandb'</span>: <span style=\"color: #ff0000; text-decoration-color: #ff0000; font-style: italic\">False</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'learning_rate'</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">{</span><span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'clip_norm'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1.0</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'lr_init'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1e-05</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">}</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'loss'</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">{</span><span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'charge_weight'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.0</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'plaq_weight'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.0</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'rmse_weight'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1.0</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'use_mixed_loss'</span>: <span style=\"color: #ff0000; text-decoration-color: #ff0000; font-style: italic\">False</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">}</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'net_weights'</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">{</span><span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'v'</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">{</span><span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'q'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1.0</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'s'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1.0</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'t'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1.0</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">}</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'x'</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">{</span><span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'q'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.0</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'s'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.0</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'t'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.0</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">}}</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'network'</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">{</span><span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'activation_fn'</span>: <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'tanh'</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'dropout_prob'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.0</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'units'</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'use_batch_norm'</span>: <span style=\"color: #ff0000; text-decoration-color: #ff0000; font-style: italic\">False</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">}</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'restore'</span>: <span style=\"color: #ff0000; text-decoration-color: #ff0000; font-style: italic\">False</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'save'</span>: <span style=\"color: #ff0000; text-decoration-color: #ff0000; font-style: italic\">False</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'steps'</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">{</span><span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'log'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'nepoch'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">10</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'nera'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'print'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'test'</span>: <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">50</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">}</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'use_tb'</span>: <span style=\"color: #ff0000; text-decoration-color: #ff0000; font-style: italic\">False</span>, <span style=\"color: #2196F3; text-decoration-color: #2196F3; font-style: italic\">'use_wandb'</span>: <span style=\"color: #ff0000; text-decoration-color: #ff0000; font-style: italic\">False</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">}</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:39</span><span style=\"color:#333333;\">][</span><span style=\"color: #F4511E; text-decoration-color: #F4511E\">WARNING</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">trainer</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">467</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Using torch.float32 on cpu!\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:39</span><span style=\"color:#333333;\">][</span><span style=\"color: #F4511E; text-decoration-color: #F4511E\">WARNING</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">trainer</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">467</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Using `torch.optim.Adam` optimizer\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:39</span><span style=\"color:#333333;\">][</span><span style=\"color: #F4511E; text-decoration-color: #F4511E\">WARNING</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">trainer</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">271</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>logging with freq <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1</span> for wandb.watch\n<br>\n:::\n\n:::\n\n```python\nstate = ptExpSU3.trainer.dynamics.random_state(6.0)\nassert isinstance(state.x, torch.Tensor)\nassert isinstance(state.beta, torch.Tensor)\nassert isinstance(ptExpSU3, Experiment)\n```\n\n```python\nlog.info(f\"checkSU(x): {g.checkSU(state.x)}\")\n```\n\n::: {.callout-tip icon=false aria-title=\"output\" title='[`output`:]{.dim-text}' collapse=\"true\" style=\"text-align: left!important; width:100%; background-color:rgba(131,131,131,0.05)!important; border: 1px solid rgba(131,131,131,0.3)!important; opacity:100%;\"}\n\n::: {.cell-output .cell-output-display}\n\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:39</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">2027559912</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">1</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">checkSU</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">(</span>x<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">)</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">(</span>tensor<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> f64 xâˆˆ<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.013e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">2.845e-07</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Î¼</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">9.867e-08</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Ïƒ</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1.240e-07</span> <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.862e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4.138e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">2.845e-07</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.013e-08</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span>, tensor<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> f64 xâˆˆ<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.401e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.683e-07</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Î¼</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1.875e-07</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Ïƒ</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">2.539e-07</span> <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">6.819e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.958e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.683e-07</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.401e-08</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">])</span>\n<br>\n:::\n\n:::\n\n```python\nxhmc, history_hmc = evaluate(\n    nsteps=10,\n    exp=ptExpSU3,\n    beta=state.beta,\n    x=state.x,\n    eps=0.1,\n    nleapfrog=1,\n    job_type='hmc',\n    nlog=1,\n    nprint=2,\n    grab=True\n)\nxhmc = ptExpSU3.trainer.dynamics.unflatten(xhmc)\nlog.info(f\"checkSU(x_hmc): {g.checkSU(xhmc)}\")\nplot_metrics(history_hmc.history, title='HMC', marker='.')\n```\n\n::: {.callout-tip icon=false aria-title=\"output\" title='[`output`:]{.dim-text}' collapse=\"true\" style=\"text-align: left!important; width:100%; background-color:rgba(131,131,131,0.05)!important; border: 1px solid rgba(131,131,131,0.3)!important; opacity:100%;\"}\n\n::: {.cell-output .cell-output-display}\n\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:39</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">2419635544</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">14</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">checkSU</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">(</span>x_hmc<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">)</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">(</span>tensor<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> f64 xâˆˆ<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">2.341e-16</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.604e-16</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Î¼</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">2.931e-16</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Ïƒ</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.613e-17</span> <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">2.341e-16</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.604e-16</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">2.624e-16</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.153e-16</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span>, tensor<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> f64 xâˆˆ<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.575e-16</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.398e-16</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Î¼</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4.280e-16</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Ïƒ</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">8.496e-17</span> <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.575e-16</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4.483e-16</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.665e-16</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.398e-16</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">])</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:39</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving energy to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:40</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving logprob to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:40</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving logdet to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:40</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving acc to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:40</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving sumlogdet to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:41</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving acc_mask to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:41</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving plaqs to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:41</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving sinQ to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:41</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving intQ to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:42</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving dQint to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:42</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving dQsin to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:42</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving loss to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">HMC</span>\n<br>\n\n![](./assets/cell-11-output-14.svg)\n\n![](./assets/cell-11-output-15.svg)\n\n![](./assets/cell-11-output-16.svg)\n\n![](./assets/cell-11-output-17.svg)\n\n![](./assets/cell-11-output-18.svg)\n\n![](./assets/cell-11-output-19.svg)\n\n![](./assets/cell-11-output-20.svg)\n\n![](./assets/cell-11-output-21.svg)\n\n![](./assets/cell-11-output-22.svg)\n\n![](./assets/cell-11-output-23.svg)\n\n![](./assets/cell-11-output-24.svg)\n\n![](./assets/cell-11-output-25.svg)\n\n<!-- ![](output_9_13.png) -->\n<!---->\n<!-- ![](output_9_14.png) -->\n<!---->\n<!-- ![](output_9_15.png) -->\n<!---->\n<!-- ![](output_9_16.png) -->\n<!---->\n<!-- ![](output_9_17.png) -->\n<!---->\n<!-- ![](output_9_18.png) -->\n<!---->\n<!-- ![](output_9_19.png) -->\n<!---->\n<!-- ![](output_9_20.png) -->\n<!---->\n<!-- ![](output_9_21.png) -->\n<!---->\n<!-- ![](output_9_22.png) -->\n<!---->\n<!-- ![](output_9_23.png) -->\n<!---->\n<!-- ![](output_9_24.png) -->\n\n:::\n\n:::\n\n```python\n# ptExpSU3.trainer.dynamics.init_weights(\n#     method='uniform',\n#     min=-1e-16,\n#     max=1e-16,\n#     bias=True,\n#     # xeps=0.001,\n#     # veps=0.001,\n# )\nxeval, history_eval = evaluate(\n    nsteps=500,\n    exp=ptExpSU3,\n    beta=6.0,\n    x=state.x,\n    job_type='eval',\n    nlog=2,\n    nprint=5,\n    grab=True,\n)\nxeval = ptExpSU3.trainer.dynamics.unflatten(xeval)\nlog.info(f\"checkSU(x_eval): {g.checkSU(xeval)}\")\nplot_metrics(history_eval.history, title='Evaluate', marker='.')\n```\n\n::: {.callout-tip icon=false aria-title=\"output\" title='[`output`:]{.dim-text}' collapse=\"true\" style=\"text-align: left!important; width:100%; background-color:rgba(131,131,131,0.05)!important; border: 1px solid rgba(131,131,131,0.3)!important; opacity:100%;\"}\n\n::: {.cell-output .cell-output-display}\n\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:43</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1629827420</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">20</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">checkSU</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">(</span>x_eval<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">)</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">(</span>tensor<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> f64 xâˆˆ<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">9.602e-14</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.024</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Î¼</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.009</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Ïƒ</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.012</span> <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.024</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">2.063e-13</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.014</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">9.602e-14</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span>, tensor<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> f64 xâˆˆ<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1.796e-13</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.034</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Î¼</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.013</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Ïƒ</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.016</span> <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.034</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.935e-13</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">0.016</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1.796e-13</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">])</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:43</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving energy to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:43</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving logprob to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:44</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving logdet to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:44</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving sldf to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:44</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving sldb to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:44</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving sld to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:45</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving xeps to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:45</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving veps to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:45</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving acc to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:45</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving sumlogdet to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:45</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving beta to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:46</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving acc_mask to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:46</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving plaqs to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:46</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving sinQ to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:46</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving intQ to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:47</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving dQint to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:47</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving dQsin to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n<span style=\"color:#333333;\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:47</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">1984252221</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">10</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span>Saving loss to <span style=\"color: #008000; text-decoration-color: #008000\">/Users/samforeman/projects/saforem2/l2hmc-qcd/qmd/outputs/plots-4dSU3/</span><span style=\"color: #800080; text-decoration-color: #800080\">Evaluate</span>\n<br>\n\n![](./assets/cell-12-output-20.svg)\n\n![](./assets/cell-12-output-21.svg)\n\n![](./assets/cell-12-output-22.svg)\n\n![](./assets/cell-12-output-23.svg)\n\n![](./assets/cell-12-output-24.svg)\n\n![](./assets/cell-12-output-25.svg)\n\n![](./assets/cell-12-output-26.svg)\n\n![](./assets/cell-12-output-27.svg)\n\n![](./assets/cell-12-output-28.svg)\n\n![](./assets/cell-12-output-29.svg)\n\n![](./assets/cell-12-output-30.svg)\n\n![](./assets/cell-12-output-31.svg)\n\n![](./assets/cell-12-output-32.svg)\n\n![](./assets/cell-12-output-33.svg)\n\n![](./assets/cell-12-output-34.svg)\n\n![](./assets/cell-12-output-35.svg)\n\n![](./assets/cell-12-output-36.svg)\n\n![](./assets/cell-12-output-37.svg)\n\n<!---->\n<!-- ![](output_10_19.png) -->\n<!---->\n<!-- ![](output_10_20.png) -->\n<!---->\n<!-- ![](output_10_21.png) -->\n<!---->\n<!-- ![](output_10_22.png) -->\n<!---->\n<!-- ![](output_10_23.png) -->\n<!---->\n<!-- ![](output_10_24.png) -->\n<!---->\n<!-- ![](output_10_25.png) -->\n<!---->\n<!-- ![](output_10_26.png) -->\n<!---->\n<!-- ![](output_10_27.png) -->\n<!---->\n<!-- ![](output_10_28.png) -->\n<!---->\n<!-- ![](output_10_29.png) -->\n<!---->\n<!-- ![](output_10_30.png) -->\n<!---->\n<!-- ![](output_10_31.png) -->\n<!---->\n<!-- ![](output_10_32.png) -->\n<!---->\n<!-- ![](output_10_33.png) -->\n<!---->\n<!-- ![](output_10_34.png) -->\n<!---->\n<!-- ![](output_10_35.png) -->\n<!---->\n<!-- ![](output_10_36.png) -->\n\n:::\n\n:::\n\n```python\nx = ptExpSU3.trainer.dynamics.unflatten(state.x)\nlog.info(f\"checkSU(x_train): {g.checkSU(x)}\")\n# plot_metrics(history, title='train', marker='.')\n```\n\n::: {.callout-tip icon=false aria-title=\"output\" title='[`output`:]{.dim-text}' collapse=\"true\" style=\"text-align: left!important; width:100%; background-color:rgba(131,131,131,0.05)!important; border: 1px solid rgba(131,131,131,0.3)!important; opacity:100%;\"}\n\n::: {.cell-output .cell-output-display}\n<span style=\"color: #-000001; text-decoration-color: #000000\">[</span><span style=\"color: #808080; text-decoration-color: #808080\">2024-07-04 11:44:49</span><span style=\"color:#333333;\">][</span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">INFO</span><span style=\"color:#333333;\">][</span><span style=\"color: #008080; text-decoration-color: #008080; font-style: italic\">3331171632</span><span style=\"color: #2196F3; text-decoration-color: #2196F3\">:</span><span style=\"color:#333333;\">2</span><span style=\"color:#333333;\">]</span><span style=\"color: #333333; text-decoration-color: #333333; font-weight: bold\"> - </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">checkSU</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">(</span>x_train<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">)</span>: <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">(</span>tensor<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> f64 xâˆˆ<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.013e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">2.845e-07</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Î¼</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">9.867e-08</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Ïƒ</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1.240e-07</span> <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.862e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4.138e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">2.845e-07</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">3.013e-08</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span>, tensor<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">4</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> f64 xâˆˆ<span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.401e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.683e-07</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">]</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Î¼</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">1.875e-07</span> <span style=\"color: #0000ff; text-decoration-color: #0000ff; font-style: italic\">Ïƒ</span>=<span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">2.539e-07</span> <span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">[</span><span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">6.819e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.958e-08</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.683e-07</span>, <span style=\"color: #ff00ff; text-decoration-color: #ff00ff\">5.401e-08</span><span style=\"color: #666666; text-decoration-color: #666666; font-weight: bold\">])</span>\n:::\n\n:::\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}